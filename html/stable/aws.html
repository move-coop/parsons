

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Amazon Web Services &mdash; Parsons  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=7ab3649f" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Azure: Blob Storage" href="azure.html" />
    <link rel="prev" title="Auth0" href="auth0.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Parsons
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Integrations</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="actblue.html">ActBlue</a></li>
<li class="toctree-l1"><a class="reference internal" href="action_kit.html">ActionKit</a></li>
<li class="toctree-l1"><a class="reference internal" href="action_builder.html">Action Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="action_network.html">Action Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="airtable.html">Airtable</a></li>
<li class="toctree-l1"><a class="reference internal" href="alchemer.html">Alchemer</a></li>
<li class="toctree-l1"><a class="reference internal" href="auth0.html">Auth0</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Amazon Web Services</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#lambda">Lambda</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quickstart">QuickStart</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api">API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#parsons.aws.distribute_task"><code class="docutils literal notranslate"><span class="pre">distribute_task()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#parsons.aws.event_command"><code class="docutils literal notranslate"><span class="pre">event_command()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#s3">S3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#aws-s3">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">QuickStart</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#parsons.S3"><code class="docutils literal notranslate"><span class="pre">S3</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#temporary-credentials">Temporary Credentials</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#redshift">Redshift</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id7">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">Quickstart</a></li>
<li class="toctree-l3"><a class="reference internal" href="#core-api">Core API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#parsons.Redshift"><code class="docutils literal notranslate"><span class="pre">Redshift</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#parsons.Redshift.connection"><code class="docutils literal notranslate"><span class="pre">connection()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#parsons.Redshift.query"><code class="docutils literal notranslate"><span class="pre">query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#parsons.Redshift.query_with_connection"><code class="docutils literal notranslate"><span class="pre">query_with_connection()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#parsons.Redshift.copy"><code class="docutils literal notranslate"><span class="pre">copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#parsons.Redshift.copy_s3"><code class="docutils literal notranslate"><span class="pre">copy_s3()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#parsons.Redshift.unload"><code class="docutils literal notranslate"><span class="pre">unload()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#parsons.Redshift.upsert"><code class="docutils literal notranslate"><span class="pre">upsert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#parsons.Redshift.generate_manifest"><code class="docutils literal notranslate"><span class="pre">generate_manifest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#parsons.Redshift.alter_table_column_type"><code class="docutils literal notranslate"><span class="pre">alter_table_column_type()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#table-and-view-api">Table and View API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities"><code class="docutils literal notranslate"><span class="pre">RedshiftTableUtilities</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#schema-api">Schema API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#parsons.databases.redshift.redshift.RedshiftSchema"><code class="docutils literal notranslate"><span class="pre">RedshiftSchema</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="azure.html">Azure: Blob Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="bill_com.html">Bill.com</a></li>
<li class="toctree-l1"><a class="reference internal" href="bloomerang.html">Bloomerang</a></li>
<li class="toctree-l1"><a class="reference internal" href="box.html">Box</a></li>
<li class="toctree-l1"><a class="reference internal" href="braintree.html">Braintree</a></li>
<li class="toctree-l1"><a class="reference internal" href="capitolcanary.html">CapitolCanary</a></li>
<li class="toctree-l1"><a class="reference internal" href="census.html">Census</a></li>
<li class="toctree-l1"><a class="reference internal" href="civis.html">Civis</a></li>
<li class="toctree-l1"><a class="reference internal" href="controlshift.html">Controlshift</a></li>
<li class="toctree-l1"><a class="reference internal" href="copper.html">Copper</a></li>
<li class="toctree-l1"><a class="reference internal" href="crowdtangle.html">CrowdTangle</a></li>
<li class="toctree-l1"><a class="reference internal" href="databases.html">Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="donorbox.html">Donorbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="facebook_ads.html">FacebookAds</a></li>
<li class="toctree-l1"><a class="reference internal" href="formstack.html">Formstack</a></li>
<li class="toctree-l1"><a class="reference internal" href="freshdesk.html">Freshdesk</a></li>
<li class="toctree-l1"><a class="reference internal" href="github.html">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="google.html">Google</a></li>
<li class="toctree-l1"><a class="reference internal" href="hustle.html">Hustle</a></li>
<li class="toctree-l1"><a class="reference internal" href="mailchimp.html">Mailchimp</a></li>
<li class="toctree-l1"><a class="reference internal" href="mobilecommons.html">MobileCommons</a></li>
<li class="toctree-l1"><a class="reference internal" href="mobilize_america.html">Mobilize America</a></li>
<li class="toctree-l1"><a class="reference internal" href="nation_builder.html">NationBuilder</a></li>
<li class="toctree-l1"><a class="reference internal" href="newmode.html">New/Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="ngpvan.html">NGPVAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="p2a.html">Phone2Action</a></li>
<li class="toctree-l1"><a class="reference internal" href="pdi.html">PDI</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickbase.html">Quickbase</a></li>
<li class="toctree-l1"><a class="reference internal" href="redash.html">Redash</a></li>
<li class="toctree-l1"><a class="reference internal" href="rockthevote.html">Rock the Vote</a></li>
<li class="toctree-l1"><a class="reference internal" href="salesforce.html">Salesforce</a></li>
<li class="toctree-l1"><a class="reference internal" href="scytl.html">Scytl</a></li>
<li class="toctree-l1"><a class="reference internal" href="sftp.html">SFTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="shopify.html">Shopify</a></li>
<li class="toctree-l1"><a class="reference internal" href="sisense.html">Sisense</a></li>
<li class="toctree-l1"><a class="reference internal" href="targetsmart.html">TargetSmart</a></li>
<li class="toctree-l1"><a class="reference internal" href="turbovote.html">TurboVote</a></li>
<li class="toctree-l1"><a class="reference internal" href="twilio.html">Twilio</a></li>
<li class="toctree-l1"><a class="reference internal" href="zoom.html">Zoom</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Enhancements</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="census_geocoder.html">US Census Geocoder</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Framework</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dbsync.html">Database Sync</a></li>
<li class="toctree-l1"><a class="reference internal" href="table.html">Parsons Table</a></li>
<li class="toctree-l1"><a class="reference internal" href="notifications.html">Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributor Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to Parsons</a></li>
<li class="toctree-l1"><a class="reference internal" href="build_a_connector.html">How to Build a Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="write_tests.html">How to Write Tests for Parsons Connectors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Use Cases and Sample Scripts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="use_cases/contribute_use_cases.html">How to Contribute a Use Case &amp; Sample Script</a></li>
<li class="toctree-l1"><a class="reference internal" href="use_cases/civis_job_status_slack_alert.html">Civis Job Status Slack Alert</a></li>
<li class="toctree-l1"><a class="reference internal" href="use_cases/mysql_to_googlesheets.html">MySQL to Google Sheets Export</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Training Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="training_guides/getting_set_up.html">Getting Set Up With Parsons</a></li>
<li class="toctree-l1"><a class="reference internal" href="training_guides/etl_best_practices.html">Introduction to ETL Best Practices</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Parsons</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Amazon Web Services</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/aws.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="amazon-web-services">
<h1>Amazon Web Services<a class="headerlink" href="#amazon-web-services" title="Link to this heading"></a></h1>
<p>Parsons provides utility functions and/or connectors for three different <a class="reference external" href="https://aws.amazon.com/">AWS services</a>.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#aws-lambda"><span class="std std-ref">Lambda</span></a>: AWS’s <a class="reference external" href="https://aws.amazon.com/lambda/">serverless computing platform</a></p></li>
<li><p><a class="reference internal" href="#aws-s3"><span class="std std-ref">S3</span></a>: AWS’s <a class="reference external" href="https://aws.amazon.com/s3/">object storage service</a></p></li>
<li><p><a class="reference internal" href="#id7"><span class="std std-ref">Redshift</span></a>: AWS’s <a class="reference external" href="https://aws.amazon.com/redshift/">data warehousing service</a>, with two additional classes providing utility functions.</p>
<ul>
<li><p><a class="reference internal" href="#redshift-table-and-view-api"><span class="std std-ref">Table and View API</span></a>: Methods for managing tables and views</p></li>
<li><p><a class="reference internal" href="#redshift-schema-api"><span class="std std-ref">Schema API</span></a>: Methods for managing schema</p></li>
</ul>
</li>
</ul>
<p>See the documentation for each service for more details.</p>
<section id="lambda">
<h2>Lambda<a class="headerlink" href="#lambda" title="Link to this heading"></a></h2>
<section id="overview">
<span id="aws-lambda"></span><h3>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h3>
<p>Parsons’ <code class="docutils literal notranslate"><span class="pre">distribute_task</span></code> function allows you to distribute process rows of a table across multiple
<a class="reference external" href="https://aws.amazon.com/lambda/">AWS Lambda</a> invocations.</p>
<p>If you are running the processing of a table inside AWS Lambda, then you are limited by how many rows can be processed
within the Lambda’s time limit (at time-of-writing, maximum 15min).</p>
<p>Based on experience and some napkin math, with the same data that would allow 1000 rows to be processed inside a single
AWS Lambda instance, this method allows 10 MILLION rows to be processed.</p>
<p>Rather than converting the table to SQS or other options, the fastest way is to upload the table to S3, and then invoke
multiple Lambda sub-invocations, each of which can be sent a byte-range of the data in the S3 CSV file for which to process.</p>
<p>Using this method requires some setup. You have three tasks:</p>
<ol class="arabic simple">
<li><p>Define the function to process rows, the first argument, must take your table’s data (though only a subset of rows will be passed) (e.g. <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">task_for_distribution(table,</span> <span class="pre">**kwargs):</span></code>)</p></li>
<li><p>Where you would have run <code class="docutils literal notranslate"><span class="pre">task_for_distribution(my_table,</span> <span class="pre">**kwargs)</span></code> instead call <code class="docutils literal notranslate"><span class="pre">distribute_task(my_table,</span> <span class="pre">task_for_distribution,</span> <span class="pre">func_kwargs=kwargs)</span></code> (either setting env var S3_TEMP_BUCKET or passing a <code class="docutils literal notranslate"><span class="pre">bucket=</span></code> parameter)</p></li>
<li><p>Setup your Lambda handler to include <a class="reference internal" href="#parsons.aws.event_command" title="parsons.aws.event_command"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parsons.aws.event_command()</span></code></a> (or run and deploy your lambda with <a class="reference external" href="https://github.com/Miserlou/Zappa">Zappa</a>)</p></li>
</ol>
<p>To test locally, include the argument <code class="docutils literal notranslate"><span class="pre">storage=&quot;local&quot;</span></code>, which will test the <code class="docutils literal notranslate"><span class="pre">distribute_task</span></code> function, but run the task sequentially and in local memory.</p>
</section>
<section id="quickstart">
<h3>QuickStart<a class="headerlink" href="#quickstart" title="Link to this heading"></a></h3>
<p>A minimalistic example Lambda handler might look something like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">parsons.aws</span><span class="w"> </span><span class="kn">import</span> <span class="n">event_command</span><span class="p">,</span> <span class="n">distribute_task</span>

<span class="k">def</span><span class="w"> </span><span class="nf">process_table</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">foo</span><span class="p">,</span> <span class="n">bar</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
        <span class="n">do_sloooooow_thing</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">foo</span><span class="p">,</span> <span class="n">bar</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="c1">## ADD THESE TWO LINES TO TOP OF HANDLER:</span>
    <span class="k">if</span> <span class="n">event_command</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="k">return</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">FakeDatasource</span><span class="o">.</span><span class="n">load_to_table</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;123&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
    <span class="c1"># table is so big that running</span>
    <span class="c1">#   process_table(table, foo=789, bar=&#39;baz&#39;) would timeout</span>
    <span class="c1"># so instead we:</span>
    <span class="n">distribute_task</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">process_table</span><span class="p">,</span>
                    <span class="n">bucket</span><span class="o">=</span><span class="s1">&#39;my-temp-s3-bucket&#39;</span><span class="p">,</span>
                    <span class="n">func_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="mi">789</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">:</span> <span class="s1">&#39;baz&#39;</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="api">
<h3>API<a class="headerlink" href="#api" title="Link to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="parsons.aws.distribute_task">
<span class="sig-prename descclassname"><span class="pre">parsons.aws.</span></span><span class="sig-name descname"><span class="pre">distribute_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func_to_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bucket</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func_class_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'s3'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_s3_env_token</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/aws/lambda_distribute.html#distribute_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.aws.distribute_task" title="Link to this definition"></a></dt>
<dd><p>Distribute processing rows in a table across multiple AWS Lambda invocations.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>table: Parsons Table</dt><dd><p>Table of data you wish to distribute processing across Lambda invocations
of <cite>func_to_run</cite> argument.</p>
</dd>
<dt>func_to_run: function</dt><dd><p>The function you want to run whose
first argument will be a subset of table</p>
</dd>
<dt>bucket: str</dt><dd><p>The bucket name to use for s3 upload to process the whole table
Not required if you set environment variable <code class="docutils literal notranslate"><span class="pre">S3_TEMP_BUCKET</span></code></p>
</dd>
<dt>func_kwargs: dict</dt><dd><p>If the function has other arguments to pass along with <cite>table</cite>
then provide them as a dict here. They must all be JSON-able.</p>
</dd>
<dt>func_class: class</dt><dd><p>If the function is a classmethod or function on a class,
then pass the pure class here.
E.g. If you passed <cite>ActionKit.bulk_upload_table</cite>,
then you would pass <cite>ActionKit</cite> here.</p>
</dd>
<dt>func_class_kwargs: dict</dt><dd><p>If it is a class function, and the class must be instantiated,
then pass the kwargs to instantiate the class here.
E.g. If you passed <cite>ActionKit.bulk_upload_table</cite> as the function,
then you would pass {‘domain’: …, ‘username’: … etc} here.
This must all be JSON-able data.</p>
</dd>
<dt>catch: bool</dt><dd><p>Lambda will retry running an event three times if there’s an
exception – if you want to prevent this, set <cite>catch=True</cite>
and then it will catch any errors and stop retries.
The error will be in CloudWatch logs with string “Distribute Error”
This might be important if row-actions are not idempotent and your
own function might fail causing repeats.</p>
</dd>
<dt>group_count: int</dt><dd><p>Set this to how many rows to process with each Lambda invocation (Default: 100)</p>
</dd>
<dt>storage: str</dt><dd><p>Debugging option: Defaults to “s3”. To test distribution locally without s3,
set to “local”.</p>
</dd>
<dt>use_s3_env_token: str</dt><dd><p>If storage is set to “s3”, sets the use_env_token parameter on the S3 storage.</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><p>Debug information – do not rely on the output, as it will change
depending on how this method is invoked.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parsons.aws.event_command">
<span class="sig-prename descclassname"><span class="pre">parsons.aws.</span></span><span class="sig-name descname"><span class="pre">event_command</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/aws/aws_async.html#event_command"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.aws.event_command" title="Link to this definition"></a></dt>
<dd><p>Minimal <a class="reference external" href="https://en.wikipedia.org/wiki/Shim_(computing)">shim</a>
to add to the top lambda handler function to enable distributed tasks</p>
<p>The rest of this library is compatible with zappa.async library.
If you have deployed your app with <a class="reference external" href="https://github.com/Miserlou/Zappa">Zappa</a>,
then you do NOT need to add this shim.</p>
</dd></dl>

</section>
<p></p>
</section>
<section id="s3">
<h2>S3<a class="headerlink" href="#s3" title="Link to this heading"></a></h2>
<section id="aws-s3">
<span id="id3"></span><h3>Overview<a class="headerlink" href="#aws-s3" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">S3</span></code> class allows interaction with Amazon Web Service’s <a class="reference external" href="https://aws.amazon.com/s3/">object storage service</a>
to store and access data objects. It is a wrapper around the AWS SDK <a class="reference external" href="https://boto3.amazonaws.com/v1/documentation/api/latest/index.html">boto3</a>.
It provides methods to upload and download files from S3 as well as manipulate buckets.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Authentication</dt><dd><p>Access to S3 is controlled through AWS Identity and Access Management (IAM) users in the <a class="reference external" href="https://aws.amazon.com/console/">AWS Managerment Console</a> .
Users can be granted granular access to AWS resources, including S3. IAM users are provisioned keys, which are required to access the S3 class.</p>
</dd>
</dl>
</div>
</section>
<section id="id5">
<h3>QuickStart<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<p>S3 credentials can be passed as environmental variables (<code class="docutils literal notranslate"><span class="pre">AWS_ACCESS_KEY_ID</span></code> and <code class="docutils literal notranslate"><span class="pre">AWS_SECRET_ACCESS_KEY</span></code>),
stored in an AWS CLI file <code class="docutils literal notranslate"><span class="pre">~/.aws/credentials</span></code>, or passed as keyword arguments.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">parsons</span><span class="w"> </span><span class="kn">import</span> <span class="n">S3</span>

<span class="c1"># First approach: Pass API credentials via environmental variables or an AWS CLI file</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">S3</span><span class="p">()</span>

<span class="c1"># Second approach: Pass API credentials as arguments</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">S3</span><span class="p">(</span><span class="n">aws_access_key_id</span><span class="o">=</span><span class="s1">&#39;MY_KEY&#39;</span><span class="p">,</span> <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="s1">&#39;MY_SECRET&#39;</span><span class="p">)</span>

<span class="c1"># Put an arbitrary file in an S3 bucket</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;winning_formula.csv&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">w</span><span class="p">:</span>
    <span class="n">s3</span><span class="o">.</span><span class="n">put_file</span><span class="p">(</span><span class="s1">&#39;my_bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;winning.csv, w)</span>

<span class="c1"># Put a Parsons Table as a CSV using convenience method.</span>
<span class="n">tbl</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;winning_formula.csv&#39;</span><span class="p">)</span>
<span class="n">tbl</span><span class="o">.</span><span class="n">to_s3_csv</span><span class="p">(</span><span class="s1">&#39;my_bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;winning.csv&#39;</span><span class="p">)</span>

<span class="c1"># Download a csv file and convert to a table</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="s1">&#39;my_bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;my_dir/my_file.csv&#39;</span><span class="p">)</span>
<span class="n">tbl</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="c1"># List buckets that you have access to</span>
<span class="n">s3</span><span class="o">.</span><span class="n">list_buckets</span><span class="p">()</span>

<span class="c1"># List the keys in a bucket</span>
<span class="n">s3</span><span class="o">.</span><span class="n">list_keys</span><span class="p">(</span><span class="s1">&#39;my_bucket&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id6">
<h3>API<a class="headerlink" href="#id6" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="parsons.S3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">parsons.</span></span><span class="sig-name descname"><span class="pre">S3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aws_access_key_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aws_secret_access_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aws_session_token</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_env_token</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/aws/s3.html#S3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.S3" title="Link to this definition"></a></dt>
<dd><p>Instantiate the S3 class.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>aws_access_key_id: str</dt><dd><p>The AWS access key id. Not required if the <code class="docutils literal notranslate"><span class="pre">AWS_ACCESS_KEY_ID</span></code> env variable
is set.</p>
</dd>
<dt>aws_secret_access_key: str</dt><dd><p>The AWS secret access key. Not required if the <code class="docutils literal notranslate"><span class="pre">AWS_SECRET_ACCESS_KEY</span></code> env
variable is set.</p>
</dd>
<dt>aws_session_token: str</dt><dd><p>The AWS session token. Optional. Can also be stored in the <code class="docutils literal notranslate"><span class="pre">AWS_SESSION_TOKEN</span></code>
env variable. Used for accessing S3 with temporary credentials.</p>
</dd>
<dt>use_env_token: boolean</dt><dd><p>Controls use of the <code class="docutils literal notranslate"><span class="pre">AWS_SESSION_TOKEN</span></code> environment variable. Defaults
to <code class="docutils literal notranslate"><span class="pre">True</span></code>. Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> in order to ignore the <code class="docutils literal notranslate"><span class="pre">AWS_SESSION_TOKEN</span></code> environment
variable even if the <code class="docutils literal notranslate"><span class="pre">aws_session_token</span></code> argument was not passed in.</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><p>S3 class.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="parsons.S3.s3">
<span class="sig-name descname"><span class="pre">s3</span></span><a class="headerlink" href="#parsons.S3.s3" title="Link to this definition"></a></dt>
<dd><p>Boto3 API Session Resource object. Use for more advanced boto3 features.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="parsons.S3.client">
<span class="sig-name descname"><span class="pre">client</span></span><a class="headerlink" href="#parsons.S3.client" title="Link to this definition"></a></dt>
<dd><p>Boto3 API Session client object. Use for more advanced boto3 features.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.S3.list_buckets">
<span class="sig-name descname"><span class="pre">list_buckets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/aws/s3.html#S3.list_buckets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.S3.list_buckets" title="Link to this definition"></a></dt>
<dd><p>List all buckets to which you have access.</p>
<dl class="simple">
<dt><cite>Returns:</cite></dt><dd><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.S3.bucket_exists">
<span class="sig-name descname"><span class="pre">bucket_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/aws/s3.html#S3.bucket_exists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.S3.bucket_exists" title="Link to this definition"></a></dt>
<dd><p>Determine if a bucket exists and you have access to it.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>bucket: str</dt><dd><p>The bucket name</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><dl class="simple">
<dt>boolean</dt><dd><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the bucket exists and <code class="docutils literal notranslate"><span class="pre">False</span></code> if not.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.S3.list_keys">
<span class="sig-name descname"><span class="pre">list_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_modified_before</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_modified_after</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/aws/s3.html#S3.list_keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.S3.list_keys" title="Link to this definition"></a></dt>
<dd><p>List the keys in a bucket, along with extra info about each one.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>bucket: str</dt><dd><p>The bucket name</p>
</dd>
<dt>prefix: str</dt><dd><p>Limits the response to keys that begin with the specified prefix.</p>
</dd>
<dt>suffix: str</dt><dd><p>Limits the response to keys that end with specified suffix</p>
</dd>
<dt>regex: str</dt><dd><p>Limits the reponse to keys that match a regex pattern</p>
</dd>
<dt>date_modified_before: datetime.datetime</dt><dd><p>Limits the response to keys with date modified before</p>
</dd>
<dt>date_modified_after: datetime.datetime</dt><dd><p>Limits the response to keys with date modified after</p>
</dd>
<dt>kwargs:</dt><dd><p>Additional arguments for the S3 API call. See <a class="reference external" href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/s3.html#S3.Client.list_objects_v2">AWS ListObjectsV2 documentation</a>
for more info.</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><dl class="simple">
<dt>dict</dt><dd><p>Dict mapping the keys to info about each key. The info includes ‘LastModified’,
‘Size’, and ‘Owner’.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.S3.key_exists">
<span class="sig-name descname"><span class="pre">key_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/aws/s3.html#S3.key_exists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.S3.key_exists" title="Link to this definition"></a></dt>
<dd><p>Determine if a key exists in a bucket.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>bucket: str</dt><dd><p>The bucket name</p>
</dd>
<dt>key: str</dt><dd><p>The object key</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><dl class="simple">
<dt>boolean</dt><dd><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if key exists and <code class="docutils literal notranslate"><span class="pre">False</span></code> if not.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.S3.create_bucket">
<span class="sig-name descname"><span class="pre">create_bucket</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/aws/s3.html#S3.create_bucket"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.S3.create_bucket" title="Link to this definition"></a></dt>
<dd><p>Create an s3 bucket.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>S3 has a limit on the number of buckets you can create in an AWS account, and
that limit is fairly low (typically 100). If you are creating buckets frequently,
you may be mis-using S3, and should consider using the same bucket for multiple tasks.
There is no limit on the number of objects in a bucket.
See <a class="reference external" href="https://docs.aws.amazon.com/AmazonS3/latest/dev/BucketRestrictions.html">AWS bucket restrictions</a> for more
info.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>S3 bucket names are <em>globally</em> unique. So when creating a new bucket,
the name can’t collide with any existing bucket names. If the provided name does
collide, you’ll see errors like <cite>IllegalLocationConstraintException</cite> or
<cite>BucketAlreadyExists</cite>.</p>
</div>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>bucket: str</dt><dd><p>The name of the bucket to create</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.S3.put_file">
<span class="sig-name descname"><span class="pre">put_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bucket-owner-full-control'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/aws/s3.html#S3.put_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.S3.put_file" title="Link to this definition"></a></dt>
<dd><p>Uploads an object to an S3 bucket</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>bucket: str</dt><dd><p>The bucket name</p>
</dd>
<dt>key: str</dt><dd><p>The object key</p>
</dd>
<dt>local_path: str</dt><dd><p>The local path of the file to upload</p>
</dd>
<dt>acl: str</dt><dd><p>The S3 permissions on the file</p>
</dd>
<dt>kwargs:</dt><dd><p>Additional arguments for the S3 API call. See <a class="reference external" href="https://docs.aws.amazon.com/AmazonS3/latest/API/RESTObjectPUT.html">AWS Put Object documentation</a> for more
info.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.S3.remove_file">
<span class="sig-name descname"><span class="pre">remove_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/aws/s3.html#S3.remove_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.S3.remove_file" title="Link to this definition"></a></dt>
<dd><p>Deletes an object from an S3 bucket</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>bucket: str</dt><dd><p>The bucket name</p>
</dd>
<dt>key: str</dt><dd><p>The object key</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.S3.get_file">
<span class="sig-name descname"><span class="pre">get_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/aws/s3.html#S3.get_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.S3.get_file" title="Link to this definition"></a></dt>
<dd><p>Download an object from S3 to a local file</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>local_path: str</dt><dd><p>The local path where the file will be downloaded. If not specified, a temporary
file will be created and returned, and that file will be removed automatically
when the script is done running.</p>
</dd>
<dt>bucket: str</dt><dd><p>The bucket name</p>
</dd>
<dt>key: str</dt><dd><p>The object key</p>
</dd>
<dt>kwargs:</dt><dd><p>Additional arguments for the S3 API call. See <a class="reference external" href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/s3.html#S3.Client.download_file">AWS download_file documentation</a>
for more info.</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><dl class="simple">
<dt>str</dt><dd><p>The path of the new file</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.S3.get_url">
<span class="sig-name descname"><span class="pre">get_url</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expires_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/aws/s3.html#S3.get_url"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.S3.get_url" title="Link to this definition"></a></dt>
<dd><p>Generates a presigned url for an s3 object.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>bucket: str</dt><dd><p>The bucket name</p>
</dd>
<dt>key: str</dt><dd><p>The object name</p>
</dd>
<dt>expires_in: int</dt><dd><p>The time, in seconds, until the url expires</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><dl class="simple">
<dt>Url:</dt><dd><p>A link to download the object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.S3.transfer_bucket">
<span class="sig-name descname"><span class="pre">transfer_bucket</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">origin_bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destination_bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destination_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_modified_before</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_modified_after</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">public_read</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_original</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/aws/s3.html#S3.transfer_bucket"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.S3.transfer_bucket" title="Link to this definition"></a></dt>
<dd><p>Transfer files between s3 buckets</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>origin_bucket: str</dt><dd><p>The origin bucket</p>
</dd>
<dt>origin_key: str</dt><dd><p>The origin file or prefix</p>
</dd>
<dt>destination_bucket: str</dt><dd><p>The destination bucket</p>
</dd>
<dt>destination_key: str</dt><dd><p>If <cite>None</cite> then will retain the <cite>origin key</cite>. If set to prefix will move all
to new prefix</p>
</dd>
<dt>suffix: str</dt><dd><p>Limits the response to keys that end with specified suffix</p>
</dd>
<dt>regex: str</dt><dd><p>Limits the reponse to keys that match a regex pattern</p>
</dd>
<dt>date_modified_before: datetime.datetime</dt><dd><p>Limits the response to keys with date modified before</p>
</dd>
<dt>date_modified_after: datetime.datetime</dt><dd><p>Limits the response to keys with date modified after</p>
</dd>
<dt>public_read: bool</dt><dd><p>If the keys should be set to <cite>public-read</cite></p>
</dd>
<dt>remove_original: bool</dt><dd><p>If the original keys should be removed after transfer</p>
</dd>
<dt>kwargs:</dt><dd><p>Additional arguments for the S3 API call. See <a class="reference external" href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/s3.html#S3.Client.copy">AWS download_file docs</a>
for more info.</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.S3.get_buckets_with_subname">
<span class="sig-name descname"><span class="pre">get_buckets_with_subname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bucket_subname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/aws/s3.html#S3.get_buckets_with_subname"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.S3.get_buckets_with_subname" title="Link to this definition"></a></dt>
<dd><p>Grabs a type of bucket based on naming convention.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>subname: str</dt><dd><p>This will most commonly be a ‘vendor’</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><dl class="simple">
<dt>list</dt><dd><p>list of buckets</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="temporary-credentials">
<h3>Temporary Credentials<a class="headerlink" href="#temporary-credentials" title="Link to this heading"></a></h3>
<p>The S3 API supports creating temporary credentials for one-off operations, such as pushing a file to a particular key in a particular bucket.
For example, the Mapbox API allows you to request temporary credentials that grant you access to a bucket where you can upload map data.
When S3 returns a set of temporary credentials it also returns a session token that needs to be included with the standard credentials for
them to be accepted. The <code class="docutils literal notranslate"><span class="pre">S3</span></code> class can be passed a session token as an environmental variable (<code class="docutils literal notranslate"><span class="pre">AWS_SESSION_TOKEN</span></code>) or as a keyword argument.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">parsons</span><span class="w"> </span><span class="kn">import</span> <span class="n">S3</span>

<span class="c1"># First approach: Pass session token via AWS_SESSION_TOKEN environmental variable</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">S3</span><span class="p">()</span>

<span class="c1"># Second approach: Pass session token as an argument</span>
<span class="n">creds</span> <span class="o">=</span> <span class="n">request_temporary_credentials</span><span class="p">()</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">S3</span><span class="p">(</span><span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">creds</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">creds</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">],</span>
        <span class="n">aws_session_token</span><span class="o">=</span><span class="n">creds</span><span class="p">[</span><span class="s1">&#39;token&#39;</span><span class="p">])</span>
</pre></div>
</div>
</section>
</section>
<section id="redshift">
<h2>Redshift<a class="headerlink" href="#redshift" title="Link to this heading"></a></h2>
<section id="id7">
<span id="id8"></span><h3>Overview<a class="headerlink" href="#id7" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Redshift</span></code> class allows you to interact with an <a class="reference external" href="https://aws.amazon.com/redshift/">Amazon Redshift</a> relational database.
The connector utilizes the <a class="reference external" href="https://pypi.org/project/psycopg2/">psycopg2</a> Python package under the hood. The core methods
focus on input, output and querying of the database.</p>
<p>In addition to the core API integration provided by the <code class="docutils literal notranslate"><span class="pre">Redshift</span></code> class, Parsons also includes utility functions for
managing schemas and tables. See <a class="reference internal" href="#redshift-table-and-view-api"><span class="std std-ref">Table and View API</span></a> and <a class="reference internal" href="#redshift-schema-api"><span class="std std-ref">Schema API</span></a> for more information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>S3 Credentials</dt><dd><p>Redshift only allows data to be copied to the database via S3. As such, the the <code class="xref py py-meth docutils literal notranslate"><span class="pre">copy()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">copy_s3()</span></code>
methods require S3 credentials and write access on an S3 Bucket, which will be used for storing data en route to
Redshift. See the <a class="reference external" href="https://docs.aws.amazon.com/redshift/latest/dg/copy-parameters-authorization.html">API documentation</a>
for more information about AWS Redshift authorization.</p>
</dd>
<dt>Whitelisting</dt><dd><p>Remember to ensure that the IP address from which you are connecting has been whitelisted.</p>
</dd>
</dl>
</div>
</section>
<section id="id9">
<h3>Quickstart<a class="headerlink" href="#id9" title="Link to this heading"></a></h3>
<p>Redshift API credentials can either be passed as environmental variables (<code class="docutils literal notranslate"><span class="pre">REDSHIFT_USERNAME</span></code>, <code class="docutils literal notranslate"><span class="pre">REDSHIFT_PASSWORD</span></code>,
<code class="docutils literal notranslate"><span class="pre">REDSHIFT_HOST</span></code>, <code class="docutils literal notranslate"><span class="pre">REDSHIFT_DB</span></code>, and <code class="docutils literal notranslate"><span class="pre">REDSHIFT_PORT</span></code>) or as keyword arguments. Methods that use COPY require an
<a class="reference external" href="https://docs.aws.amazon.com/redshift/latest/dg/copy-parameters-authorization.html">access key ID and a secret access key</a>,
which can also be passed as environmental variables (<code class="docutils literal notranslate"><span class="pre">aws_access_key_id</span></code> and <code class="docutils literal notranslate"><span class="pre">aws_secret_access_key</span></code>)
or keyword arguments.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">parsons</span><span class="w"> </span><span class="kn">import</span> <span class="n">Redshift</span>

<span class="c1"># Pass credentials as environmental variables</span>
<span class="n">rs</span> <span class="o">=</span> <span class="n">Redshift</span><span class="p">()</span>

<span class="c1"># Pass credentials as keyword arguments</span>
<span class="n">rs</span> <span class="o">=</span> <span class="n">Redshift</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;my_username&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;my_password&#39;</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;my_host&#39;</span><span class="p">,</span>
              <span class="n">db</span><span class="o">=</span><span class="s1">&#39;my_db&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="s1">&#39;5439&#39;</span><span class="p">)</span>

<span class="c1"># Query the Database</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;select * from tmc_scratch.test_data&#39;</span><span class="p">)</span>

<span class="c1"># Copy a Parsons Table to the Database</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">tbl</span><span class="p">,</span> <span class="s1">&#39;tmc_scratch.test_table&#39;</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;drop&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>All of the standard COPY options can be passed as kwargs. See the <code class="xref py py-meth docutils literal notranslate"><span class="pre">copy()</span></code> method for all
options.</p>
</section>
<section id="core-api">
<h3>Core API<a class="headerlink" href="#core-api" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="parsons.Redshift">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">parsons.</span></span><span class="sig-name descname"><span class="pre">Redshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">host</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s3_temp_bucket</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aws_access_key_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aws_secret_access_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iam_role</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_env_token</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/redshift.html#Redshift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.Redshift" title="Link to this definition"></a></dt>
<dd><p>A Redshift class to connect to database.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>username: str</dt><dd><p>Required if env variable <code class="docutils literal notranslate"><span class="pre">REDSHIFT_USERNAME</span></code> not populated</p>
</dd>
<dt>password: str</dt><dd><p>Required if env variable <code class="docutils literal notranslate"><span class="pre">REDSHIFT_PASSWORD</span></code> not populated</p>
</dd>
<dt>host: str</dt><dd><p>Required if env variable <code class="docutils literal notranslate"><span class="pre">REDSHIFT_HOST</span></code> not populated</p>
</dd>
<dt>db: str</dt><dd><p>Required if env variable <code class="docutils literal notranslate"><span class="pre">REDSHIFT_DB</span></code> not populated</p>
</dd>
<dt>port: int</dt><dd><p>Required if env variable <code class="docutils literal notranslate"><span class="pre">REDSHIFT_PORT</span></code> not populated. Port 5439 is typical.</p>
</dd>
<dt>timeout: int</dt><dd><p>Seconds to timeout if connection not established</p>
</dd>
<dt>s3_temp_bucket: str</dt><dd><p>Name of the S3 bucket that will be used for storing data during bulk transfers.
Required if you intend to perform bulk data transfers (eg. the copy_s3 method),
and env variable <code class="docutils literal notranslate"><span class="pre">S3_TEMP_BUCKET</span></code> is not populated.</p>
</dd>
<dt>aws_access_key_id: str</dt><dd><p>The default AWS access key id for copying data from S3 into Redshift
when running copy/upsert/etc methods.
This will default to environment variable AWS_ACCESS_KEY_ID.</p>
</dd>
<dt>aws_secret_access_key: str</dt><dd><p>The default AWS secret access key for copying data from S3 into Redshift
when running copy/upsert/etc methods.
This will default to environment variable AWS_SECRET_ACCESS_KEY.</p>
</dd>
<dt>iam_role: str</dt><dd><p>AWS IAM Role ARN string – an optional, different way for credentials to
be provided in the Redshift copy command that does not require an access key.</p>
</dd>
<dt>use_env_token: bool</dt><dd><p>Controls use of the <code class="docutils literal notranslate"><span class="pre">AWS_SESSION_TOKEN</span></code> environment variable for S3. Defaults
to <code class="docutils literal notranslate"><span class="pre">True</span></code>. Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> in order to ignore the <code class="docutils literal notranslate"><span class="pre">AWS_SESSION_TOKEN</span></code> environment
variable even if the <code class="docutils literal notranslate"><span class="pre">aws_session_token</span></code> argument was not passed in.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parsons.Redshift.connection">
<span class="sig-prename descclassname"><span class="pre">parsons.Redshift.</span></span><span class="sig-name descname"><span class="pre">connection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parsons.Redshift.connection" title="Link to this definition"></a></dt>
<dd><p>Generate a Redshift connection.
The connection is set up as a python “context manager”, so it will be closed
automatically (and all queries committed) when the connection goes out of scope.</p>
<p>When using the connection, make sure to put it in a <code class="docutils literal notranslate"><span class="pre">with</span></code> block (necessary for
any context manager):
<code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">rs.connection()</span> <span class="pre">as</span> <span class="pre">conn:</span></code></p>
<dl class="simple">
<dt><cite>Returns:</cite></dt><dd><p>Psycopg2 <code class="docutils literal notranslate"><span class="pre">connection</span></code> object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parsons.Redshift.query">
<span class="sig-prename descclassname"><span class="pre">parsons.Redshift.</span></span><span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sql</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="table.html#parsons.etl.table.Table" title="parsons.etl.table.Table"><span class="pre">Table</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#parsons.Redshift.query" title="Link to this definition"></a></dt>
<dd><p>Execute a query against the Redshift database. Will return <code class="docutils literal notranslate"><span class="pre">None</span></code>
if the query returns zero rows.</p>
<p>To include python variables in your query, it is recommended to pass them as parameters,
following the <a class="reference external" href="http://initd.org/psycopg/docs/usage.html#passing-parameters-to-sql-queries">psycopg style</a>.
Using the <code class="docutils literal notranslate"><span class="pre">parameters</span></code> argument ensures that values are escaped properly, and avoids SQL
injection attacks.</p>
<p><strong>Parameter Examples</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that the name contains a quote, which could break your query if not escaped</span>
<span class="c1"># properly.</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Beatrice O&#39;Brady&quot;</span>
<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM my_table WHERE name = </span><span class="si">%s</span><span class="s2">&quot;</span>
<span class="n">rs</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Allen Smith&quot;</span><span class="p">,</span> <span class="s2">&quot;Beatrice O&#39;Brady&quot;</span><span class="p">,</span> <span class="s2">&quot;Cathy Thompson&quot;</span><span class="p">]</span>
<span class="n">placeholders</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">names</span><span class="p">)</span>
<span class="n">sql</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM my_table WHERE name IN (</span><span class="si">{</span><span class="n">placeholders</span><span class="si">}</span><span class="s2">)&quot;</span>
<span class="n">rs</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>sql: str</dt><dd><p>A valid SQL statement</p>
</dd>
<dt>parameters: list</dt><dd><p>A list of python variables to be converted into SQL values in your query</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><dl class="simple">
<dt>Parsons Table</dt><dd><p>See <a class="reference internal" href="table.html#parsons-table"><span class="std std-ref">Parsons Table</span></a> for output options.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parsons.Redshift.query_with_connection">
<span class="sig-prename descclassname"><span class="pre">parsons.Redshift.</span></span><span class="sig-name descname"><span class="pre">query_with_connection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sql</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">commit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parsons.Redshift.query_with_connection" title="Link to this definition"></a></dt>
<dd><p>Execute a query against the Redshift database, with an existing connection.
Useful for batching queries together. Will return <code class="docutils literal notranslate"><span class="pre">None</span></code> if the query
returns zero rows.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>sql: str</dt><dd><p>A valid SQL statement</p>
</dd>
<dt>connection: obj</dt><dd><p>A connection object obtained from <code class="docutils literal notranslate"><span class="pre">redshift.connection()</span></code></p>
</dd>
<dt>parameters: list</dt><dd><p>A list of python variables to be converted into SQL values in your query</p>
</dd>
<dt>commit: boolean</dt><dd><p>Whether to commit the transaction immediately. If <code class="docutils literal notranslate"><span class="pre">False</span></code> the transaction will
be committed when the connection goes out of scope and is closed (or you can
commit manually with <code class="docutils literal notranslate"><span class="pre">connection.commit()</span></code>).</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><dl class="simple">
<dt>Parsons Table</dt><dd><p>See <a class="reference internal" href="table.html#parsons-table"><span class="std std-ref">Parsons Table</span></a> for output options.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parsons.Redshift.copy">
<span class="sig-prename descclassname"><span class="pre">parsons.Redshift.</span></span><span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tbl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="table.html#parsons.etl.table.Table" title="parsons.etl.table.Table"><span class="pre">Table</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_exists</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'fail'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_errors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distkey</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sortkey</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statupdate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compupdate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptanydate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emptyasnull</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blanksasnull</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nullas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptinvchars</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dateformat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeformat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varchar_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncatecolumns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columntypes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specifycols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alter_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alter_table_cascade</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aws_access_key_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aws_secret_access_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iam_role</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleanup_s3_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp_bucket_region</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csv_encoding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'utf-8'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parsons.Redshift.copy" title="Link to this definition"></a></dt>
<dd><p>Copy a <a class="reference internal" href="table.html#parsons-table"><span class="std std-ref">Parsons Table</span></a> to Redshift.</p>
<dl>
<dt><cite>Args:</cite></dt><dd><dl>
<dt>tbl: obj</dt><dd><p>A Parsons Table.</p>
</dd>
<dt>table_name: str</dt><dd><p>The destination table name (ex. <code class="docutils literal notranslate"><span class="pre">my_schema.my_table</span></code>).</p>
</dd>
<dt>if_exists: str</dt><dd><p>If the table already exists, either <code class="docutils literal notranslate"><span class="pre">fail</span></code>, <code class="docutils literal notranslate"><span class="pre">append</span></code>, <code class="docutils literal notranslate"><span class="pre">drop</span></code>
or <code class="docutils literal notranslate"><span class="pre">truncate</span></code> the table.</p>
</dd>
<dt>max_errors: int</dt><dd><p>The maximum number of rows that can error and be skipped before
the job fails.</p>
</dd>
<dt>distkey: str</dt><dd><p>The column name of the distkey</p>
</dd>
<dt>sortkey: str</dt><dd><p>The column name of the sortkey</p>
</dd>
<dt>padding: float</dt><dd><p>A percentage padding to add to varchar columns if creating a new table. This is
helpful to add a buffer for future copies in which the data might be wider.</p>
</dd>
<dt>statupate: boolean</dt><dd><p>Governs automatic computation and refresh of optimizer statistics at the end
of a successful COPY command. If <code class="docutils literal notranslate"><span class="pre">True</span></code> explicitly sets <code class="docutils literal notranslate"><span class="pre">statupate</span></code> to on, if
<code class="docutils literal notranslate"><span class="pre">False</span></code> explicitly sets <code class="docutils literal notranslate"><span class="pre">statupate</span></code> to off. If <code class="docutils literal notranslate"><span class="pre">None</span></code> stats update only if
the table is initially empty. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.
See <a class="reference external" href="https://docs.aws.amazon.com/redshift/latest/dg/copy-parameters-data-load.html#copy-statupdate">Redshift docs</a>
for more details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If STATUPDATE is used, the current user must be either the table owner or a
superuser.</p>
</div>
</dd>
<dt>compupdate: boolean</dt><dd><p>Controls whether compression encodings are automatically applied during a COPY. If
<code class="docutils literal notranslate"><span class="pre">True</span></code> explicitly sets <code class="docutils literal notranslate"><span class="pre">compupdate</span></code> to on, if <code class="docutils literal notranslate"><span class="pre">False</span></code> explicitly sets
<code class="docutils literal notranslate"><span class="pre">compupdate</span></code> to off. If <code class="docutils literal notranslate"><span class="pre">None</span></code> the COPY command only chooses compression if the
table is initially empty. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.
See <a class="reference external" href="https://docs.aws.amazon.com/redshift/latest/dg/copy-parameters-data-load.html#copy-compupdate">Redshift docs</a>
for more details.</p>
</dd>
<dt>acceptanydate: boolean</dt><dd><p>Allows any date format, including invalid formats such as 00/00/00 00:00:00, to be
loaded without generating an error.</p>
</dd>
<dt>emptyasnull: boolean</dt><dd><p>Indicates that Amazon Redshift should load empty char and varchar fields
as <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p>
</dd>
<dt>blanksasnull: boolean</dt><dd><p>Loads blank varchar fields, which consist of only white space characters,
as <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p>
</dd>
<dt>nullas: str</dt><dd><p>Loads fields that match string as NULL</p>
</dd>
<dt>acceptinvchars: boolean</dt><dd><p>Enables loading of data into VARCHAR columns even if the data contains
invalid UTF-8 characters.</p>
</dd>
<dt>dateformat: str</dt><dd><p>Set the date format. Defaults to <code class="docutils literal notranslate"><span class="pre">auto</span></code>.</p>
</dd>
<dt>timeformat: str</dt><dd><p>Set the time format. Defaults to <code class="docutils literal notranslate"><span class="pre">auto</span></code>.</p>
</dd>
<dt>varchar_max: list</dt><dd><p>A list of columns in which to set the width of the varchar column to 65,535
characters.</p>
</dd>
<dt>truncatecolumns: boolean</dt><dd><p>If the table already exists, truncates data in columns to the appropriate number
of characters so that it fits the column specification. Applies only to columns
with a VARCHAR or CHAR data type, and rows 4 MB or less in size.</p>
</dd>
<dt>columntypes: dict</dt><dd><p>Optional map of column name to redshift column type, overriding the usual type
inference. You only specify the columns you want to override, eg.
<code class="docutils literal notranslate"><span class="pre">columntypes={'phone':</span> <span class="pre">'varchar(12)',</span> <span class="pre">'age':</span> <span class="pre">'int'})</span></code>.</p>
</dd>
<dt>specifycols: boolean</dt><dd><p>Adds a column list to the Redshift <cite>COPY</cite> command, allowing for the source table
in an append to have the columnns out of order, and to have fewer columns with any
leftover target table columns filled in with the <cite>DEFAULT</cite> value.</p>
<p>This will fail if all of the source table’s columns do not match a column in the
target table. This will also fail if the target table has an <cite>IDENTITY</cite>
column and that column name is among the source table’s columns.</p>
</dd>
<dt>alter_table: boolean</dt><dd><p>Will check if the target table varchar widths are wide enough to copy in the
table data. If not, will attempt to alter the table to make it wide enough. This
will not work with tables that have dependent views. To drop them, set
<code class="docutils literal notranslate"><span class="pre">alter_table_cascade</span></code> to True.</p>
</dd>
<dt>alter_table_cascade: boolean</dt><dd><p>Will drop dependent objects when attempting to alter the table. If <code class="docutils literal notranslate"><span class="pre">alter_table</span></code>
is <code class="docutils literal notranslate"><span class="pre">False</span></code>, this will be ignored.</p>
</dd>
<dt>aws_access_key_id:</dt><dd><p>An AWS access key granted to the bucket where the file is located. Not required
if keys are stored as environmental variables.</p>
</dd>
<dt>aws_secret_access_key:</dt><dd><p>An AWS secret access key granted to the bucket where the file is located. Not
required if keys are stored as environmental variables.</p>
</dd>
<dt>iam_role: str</dt><dd><p>An AWS IAM Role ARN string; an alternative credential for the COPY command
from Redshift to S3. The IAM role must have been assigned to the Redshift
instance and have access to the S3 bucket.</p>
</dd>
<dt>cleanup_s3_file: boolean</dt><dd><p>The s3 upload is removed by default on cleanup. You can set to False for debugging.</p>
</dd>
<dt>template_table: str</dt><dd><p>Instead of specifying columns, columntypes, and/or inference, if there
is a pre-existing table that has the same columns/types, then use the template_table
table name as the schema for the new table.
Unless you set specifycols=False explicitly, a template_table will set it to True</p>
</dd>
<dt>temp_bucket_region: str</dt><dd><p>The AWS region that the temp bucket (specified by the TEMP_S3_BUCKET environment
variable) is located in. This should be provided if the Redshift cluster is located
in a different region from the temp bucket.</p>
</dd>
<dt>strict_length: bool</dt><dd><p>Whether or not to tightly fit the length of the table columns to the length
of the data in <code class="docutils literal notranslate"><span class="pre">tbl</span></code>; if <code class="docutils literal notranslate"><span class="pre">padding</span></code> is specified, this argument is ignored.</p>
</dd>
<dt>csv_ecoding: str</dt><dd><p>String encoding to use when writing the temporary CSV file that is uploaded to S3.
Defaults to ‘utf-8’.</p>
</dd>
</dl>
</dd>
<dt><cite>Returns</cite></dt><dd><dl class="simple">
<dt>Parsons Table or <code class="docutils literal notranslate"><span class="pre">None</span></code></dt><dd><p>See <a class="reference internal" href="table.html#parsons-table"><span class="std std-ref">Parsons Table</span></a> for output options.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parsons.Redshift.copy_s3">
<span class="sig-prename descclassname"><span class="pre">parsons.Redshift.</span></span><span class="sig-name descname"><span class="pre">copy_s3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manifest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csv_delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">','</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_exists</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fail'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distkey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sortkey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varchar_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statupdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compupdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignoreheader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptanydate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dateformat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeformat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emptyasnull</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blanksasnull</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nullas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptinvchars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncatecolumns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columntypes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specifycols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aws_access_key_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aws_secret_access_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bucket_region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'utf-8'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_delimited</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parsons.Redshift.copy_s3" title="Link to this definition"></a></dt>
<dd><p>Copy a file from s3 to Redshift.</p>
<dl>
<dt><cite>Args:</cite></dt><dd><dl>
<dt>table_name: str</dt><dd><p>The table name and schema (<code class="docutils literal notranslate"><span class="pre">tmc.cool_table</span></code>) to point the file.</p>
</dd>
<dt>bucket: str</dt><dd><p>The s3 bucket where the file or manifest is located.</p>
</dd>
<dt>key: str</dt><dd><p>The key of the file or manifest in the s3 bucket.</p>
</dd>
<dt>manifest: str</dt><dd><p>If using a manifest</p>
</dd>
<dt>data_type: str</dt><dd><p>The data type of the file. Only <code class="docutils literal notranslate"><span class="pre">csv</span></code> supported currently.</p>
</dd>
<dt>csv_delimiter: str</dt><dd><p>The delimiter of the <code class="docutils literal notranslate"><span class="pre">csv</span></code>. Only relevant if data_type is <code class="docutils literal notranslate"><span class="pre">csv</span></code>.</p>
</dd>
<dt>compression: str</dt><dd><p>If specified (<code class="docutils literal notranslate"><span class="pre">gzip</span></code>), will attempt to decompress the file.</p>
</dd>
<dt>if_exists: str</dt><dd><p>If the table already exists, either <code class="docutils literal notranslate"><span class="pre">fail</span></code>, <code class="docutils literal notranslate"><span class="pre">append</span></code>, <code class="docutils literal notranslate"><span class="pre">drop</span></code>
or <code class="docutils literal notranslate"><span class="pre">truncate</span></code> the table.</p>
</dd>
<dt>max_errors: int</dt><dd><p>The maximum number of rows that can error and be skipped before
the job fails.</p>
</dd>
<dt>distkey: str</dt><dd><p>The column name of the distkey</p>
</dd>
<dt>sortkey: str</dt><dd><p>The column name of the sortkey</p>
</dd>
<dt>padding: float</dt><dd><p>A percentage padding to add to varchar columns if creating a new table. This is
helpful to add a buffer for future copies in which the data might be wider.</p>
</dd>
<dt>varchar_max: list</dt><dd><p>A list of columns in which to set the width of the varchar column to 65,535
characters.</p>
</dd>
<dt>statupate: boolean</dt><dd><p>Governs automatic computation and refresh of optimizer statistics at the end
of a successful COPY command.</p>
</dd>
<dt>compupdate: boolean</dt><dd><p>Controls whether compression encodings are automatically applied during a COPY.</p>
</dd>
<dt>ignore_header: int</dt><dd><p>The number of header rows to skip. Ignored if data_type is <code class="docutils literal notranslate"><span class="pre">json</span></code>.</p>
</dd>
<dt>acceptanydate: boolean</dt><dd><p>Allows any date format, including invalid formats such as 00/00/00 00:00:00, to be
loaded without generating an error.</p>
</dd>
<dt>emptyasnull: boolean</dt><dd><p>Indicates that Amazon Redshift should load empty char and varchar fields
as <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p>
</dd>
<dt>blanksasnull: boolean</dt><dd><p>Loads blank varchar fields, which consist of only white space characters,
as <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p>
</dd>
<dt>nullas: str</dt><dd><p>Loads fields that match string as NULL</p>
</dd>
<dt>acceptinvchars: boolean</dt><dd><p>Enables loading of data into VARCHAR columns even if the data contains
invalid UTF-8 characters.</p>
</dd>
<dt>dateformat: str</dt><dd><p>Set the date format. Defaults to <code class="docutils literal notranslate"><span class="pre">auto</span></code>.</p>
</dd>
<dt>timeformat: str</dt><dd><p>Set the time format. Defaults to <code class="docutils literal notranslate"><span class="pre">auto</span></code>.</p>
</dd>
<dt>truncatecolumns: boolean</dt><dd><p>If the table already exists, truncates data in columns to the appropriate number
of characters so that it fits the column specification. Applies only to columns
with a VARCHAR or CHAR data type, and rows 4 MB or less in size.</p>
</dd>
<dt>columntypes: dict</dt><dd><p>Optional map of column name to redshift column type, overriding the usual type
inference. You only specify the columns you want to override, eg.
<code class="docutils literal notranslate"><span class="pre">columntypes={'phone':</span> <span class="pre">'varchar(12)',</span> <span class="pre">'age':</span> <span class="pre">'int'})</span></code>.</p>
</dd>
<dt>specifycols: boolean</dt><dd><p>Adds a column list to the Redshift <cite>COPY</cite> command, allowing for the source table
in an append to have the columnns out of order, and to have fewer columns with any
leftover target table columns filled in with the <cite>DEFAULT</cite> value.</p>
<p>This will fail if all of the source table’s columns do not match a column in the
target table. This will also fail if the target table has an <cite>IDENTITY</cite>
column and that column name is among the source table’s columns.</p>
</dd>
<dt>aws_access_key_id:</dt><dd><p>An AWS access key granted to the bucket where the file is located. Not required
if keys are stored as environmental variables.</p>
</dd>
<dt>aws_secret_access_key:</dt><dd><p>An AWS secret access key granted to the bucket where the file is located. Not
required if keys are stored as environmental variables.</p>
</dd>
<dt>bucket_region: str</dt><dd><p>The AWS region that the bucket is located in. This should be provided if the
Redshift cluster is located in a different region from the temp bucket.</p>
</dd>
<dt>strict_length: bool</dt><dd><p>If the database table needs to be created, strict_length determines whether
the created table’s column sizes will be sized to exactly fit the current data,
or if their size will be rounded up to account for future values being larger
then the current dataset. defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>; this argument is ignored if
<code class="docutils literal notranslate"><span class="pre">padding</span></code> is specified</p>
</dd>
<dt>template_table: str</dt><dd><p>Instead of specifying columns, columntypes, and/or inference, if there
is a pre-existing table that has the same columns/types, then use the template_table
table name as the schema for the new table.</p>
</dd>
</dl>
</dd>
<dt><cite>Returns</cite></dt><dd><dl class="simple">
<dt>Parsons Table or <code class="docutils literal notranslate"><span class="pre">None</span></code></dt><dd><p>See <a class="reference internal" href="table.html#parsons-table"><span class="std std-ref">Parsons Table</span></a> for output options.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parsons.Redshift.unload">
<span class="sig-prename descclassname"><span class="pre">parsons.Redshift.</span></span><span class="sig-name descname"><span class="pre">unload</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sql</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manifest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'|'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gzip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_quotes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">null_as</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">escape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_file_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'6.2</span> <span class="pre">GB'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aws_region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aws_access_key_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aws_secret_access_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parsons.Redshift.unload" title="Link to this definition"></a></dt>
<dd><p>Unload Redshift data to S3 Bucket. This is a more efficient method than running a query
to export data as it can export in parallel and directly into an S3 bucket. Consider
using this for exports of 10MM or more rows.</p>
<dl class="simple">
<dt>sql: str</dt><dd><p>The SQL string to execute to generate the data to unload.</p>
</dd>
<dt>bucket: str</dt><dd><p>The destination S3 bucket</p>
</dd>
<dt>key_prefix: str</dt><dd><p>The prefix of the key names that will be written</p>
</dd>
<dt>manifest: boolean</dt><dd><p>Creates a manifest file that explicitly lists details for the data files
that are created by the UNLOAD process.</p>
</dd>
<dt>header: boolean</dt><dd><p>Adds a header line containing column names at the top of each output file.</p>
</dd>
<dt>delimiter: str</dt><dd><p>Specificies the character used to separate fields. Defaults to ‘|’.</p>
</dd>
<dt>compression: str</dt><dd><p>One of <code class="docutils literal notranslate"><span class="pre">gzip</span></code>, <code class="docutils literal notranslate"><span class="pre">bzip2</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>. Unloads data to one or more compressed
files per slice. Each resulting file is appended with a <code class="docutils literal notranslate"><span class="pre">.gz</span></code> or <code class="docutils literal notranslate"><span class="pre">.bz2</span></code> extension.</p>
</dd>
<dt>add_quotes: boolean</dt><dd><p>Places quotation marks around each unloaded data field, so that Amazon Redshift
can unload data values that contain the delimiter itself.</p>
</dd>
<dt>null_as: str</dt><dd><p>Specifies a string that represents a null value in unload files. If this option is
not specified, null values are unloaded as zero-length strings for delimited output.</p>
</dd>
<dt>escape: boolean</dt><dd><p>For CHAR and VARCHAR columns in delimited unload files, an escape character () is
placed before every linefeed, carriage return, escape characters and delimiters.</p>
</dd>
<dt>allow_overwrite: boolean</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, will overwrite existing files, including the manifest file. If <code class="docutils literal notranslate"><span class="pre">False</span></code>
will fail.</p>
</dd>
<dt>parallel: boolean</dt><dd><p>By default, UNLOAD writes data in parallel to multiple files, according to the number
of slices in the cluster. The default option is ON or TRUE. If PARALLEL is OFF or
FALSE, UNLOAD writes to one or more data files serially, sorted absolutely according
to the ORDER BY clause, if one is used.</p>
</dd>
<dt>max_file_size: str</dt><dd><p>The maximum size of files UNLOAD creates in Amazon S3. Specify a decimal value between
5 MB and 6.2 GB.</p>
</dd>
<dt>extension: str</dt><dd><p>This extension will be added to the end of file names loaded to S3</p>
</dd>
<dt>region: str</dt><dd><p>The AWS Region where the target Amazon S3 bucket is located. REGION is required for
UNLOAD to an Amazon S3 bucket that is not in the same AWS Region as the Amazon Redshift
cluster.</p>
</dd>
<dt>aws_access_key_id:</dt><dd><p>An AWS access key granted to the bucket where the file is located. Not required
if keys are stored as environmental variables.</p>
</dd>
<dt>aws_secret_access_key:</dt><dd><p>An AWS secret access key granted to the bucket where the file is located. Not
required if keys are stored as environmental variables.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parsons.Redshift.upsert">
<span class="sig-prename descclassname"><span class="pre">parsons.Redshift.</span></span><span class="sig-name descname"><span class="pre">upsert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vacuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distinct_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleanup_temp_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alter_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alter_table_cascade</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_s3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distkey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sortkey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">copy_args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parsons.Redshift.upsert" title="Link to this definition"></a></dt>
<dd><p>Preform an upsert on an existing table. An upsert is a function in which rows
in a table are updated and inserted at the same time.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>table_obj: obj</dt><dd><p>A Parsons table object</p>
</dd>
<dt>target_table: str</dt><dd><p>The schema and table name to upsert</p>
</dd>
<dt>primary_key: str or list</dt><dd><p>The primary key column(s) of the target table</p>
</dd>
<dt>vacuum: boolean</dt><dd><p>Re-sorts rows and reclaims space in the specified table. You must be a table owner
or super user to effectively vacuum a table, however the method will not fail
if you lack these priviledges.</p>
</dd>
<dt>distinct_check: boolean</dt><dd><p>Check if the primary key column is distinct. Raise error if not.</p>
</dd>
<dt>cleanup_temp_table: boolean</dt><dd><p>A temp table is dropped by default on cleanup. You can set to False for debugging.</p>
</dd>
<dt>alter_table: boolean</dt><dd><p>Set to False to avoid automatic varchar column resizing to accomodate new data</p>
</dd>
<dt>alter_table_cascade: boolean</dt><dd><p>Will drop dependent objects when attempting to alter the table. If <code class="docutils literal notranslate"><span class="pre">alter_table</span></code>
is <code class="docutils literal notranslate"><span class="pre">False</span></code>, this will be ignored.</p>
</dd>
<dt>from_s3: boolean</dt><dd><p>Instead of specifying a table_obj (set the first argument to None),
set this to True and include <code class="xref py py-func docutils literal notranslate"><span class="pre">copy_s3()</span></code> arguments
to upsert a pre-existing s3 file into the target_table</p>
</dd>
<dt>distkey: str</dt><dd><p>The column name of the distkey. If not provided, will default to <code class="docutils literal notranslate"><span class="pre">primary_key</span></code>.</p>
</dd>
<dt>sortkey: str or list</dt><dd><p>The column name(s) of the sortkey. If not provided, will default to <code class="docutils literal notranslate"><span class="pre">primary_key</span></code>.</p>
</dd>
<dt>**copy_args: kwargs</dt><dd><p>See <code class="xref py py-func docutils literal notranslate"><span class="pre">copy()</span></code> for options.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parsons.Redshift.generate_manifest">
<span class="sig-prename descclassname"><span class="pre">parsons.Redshift.</span></span><span class="sig-name descname"><span class="pre">generate_manifest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buckets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aws_access_key_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aws_secret_access_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mandatory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manifest_bucket</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manifest_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parsons.Redshift.generate_manifest" title="Link to this definition"></a></dt>
<dd><p>Given a list of S3 buckets, generate a manifest file (JSON format). A manifest file
allows you to copy multiple files into a single table at once. Once the manifest is
generated, you can pass it with the <code class="xref py py-func docutils literal notranslate"><span class="pre">copy_s3()</span></code> method.</p>
<p>AWS keys are not required if <code class="docutils literal notranslate"><span class="pre">AWS_ACCESS_KEY_ID</span></code> and
<code class="docutils literal notranslate"><span class="pre">AWS_SECRET_ACCESS_KEY</span></code> environmental variables set.</p>
<p><cite>Args:</cite></p>
<blockquote>
<div><dl class="simple">
<dt>buckets: list or str</dt><dd><p>A list of buckets or single bucket from which to generate manifest</p>
</dd>
<dt>aws_access_key_id: str</dt><dd><p>AWS access key id to access S3 bucket</p>
</dd>
<dt>aws_secret_access_key: str</dt><dd><p>AWS secret access key to access S3 bucket</p>
</dd>
<dt>mandatory: boolean</dt><dd><p>The mandatory flag indicates whether the Redshift COPY should
terminate if the file does not exist.</p>
</dd>
<dt>prefix: str</dt><dd><p>Optional filter for key prefixes</p>
</dd>
<dt>manifest_bucket: str</dt><dd><p>Optional bucket to write manifest file.</p>
</dd>
<dt>manifest_key: str</dt><dd><p>Optional key name for S3 bucket to write file</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt><cite>Returns:</cite></dt><dd><p><code class="docutils literal notranslate"><span class="pre">dict</span></code> of manifest</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="parsons.Redshift.alter_table_column_type">
<span class="sig-prename descclassname"><span class="pre">parsons.Redshift.</span></span><span class="sig-name descname"><span class="pre">alter_table_column_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varchar_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parsons.Redshift.alter_table_column_type" title="Link to this definition"></a></dt>
<dd><p>Alter a column type of an existing table.</p>
<dl class="simple">
<dt>table_name: str</dt><dd><p>The table name (ex. <code class="docutils literal notranslate"><span class="pre">my_schema.my_table</span></code>).</p>
</dd>
<dt>column_name: str</dt><dd><p>The target column name</p>
</dd>
<dt>data_type: str</dt><dd><p>A valid Redshift data type to alter the table to.</p>
</dd>
<dt>varchar_width:</dt><dd><p>The new width of the column if of type varchar.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="table-and-view-api">
<span id="redshift-table-and-view-api"></span><h3>Table and View API<a class="headerlink" href="#table-and-view-api" title="Link to this heading"></a></h3>
<p>Table and view utilities are a series of helper methods, all built off of commonly
used SQL queries run against the Redshift database.</p>
<dl class="py class">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">parsons.databases.redshift.redshift.</span></span><span class="sig-name descname"><span class="pre">RedshiftTableUtilities</span></span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.table_exists">
<span class="sig-name descname"><span class="pre">table_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.table_exists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.table_exists" title="Link to this definition"></a></dt>
<dd><p>Check if a table or view exists in the database.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>table_name: str</dt><dd><p>The table name and schema (e.g. <code class="docutils literal notranslate"><span class="pre">myschema.mytable</span></code>).</p>
</dd>
<dt>view: boolean</dt><dd><p>Check to see if a view exists by the same name</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><dl class="simple">
<dt>boolean</dt><dd><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the table exists and <code class="docutils literal notranslate"><span class="pre">False</span></code> if it does not.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.get_row_count">
<span class="sig-name descname"><span class="pre">get_row_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.get_row_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.get_row_count" title="Link to this definition"></a></dt>
<dd><p>Return the row count of a table.</p>
<p><strong>SQL Code</strong></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">myschema</span><span class="p">.</span><span class="n">mytable</span>
</pre></div>
</div>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>table_name: str</dt><dd><p>The schema and name (e.g. <code class="docutils literal notranslate"><span class="pre">myschema.mytable</span></code>) of the table.</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.rename_table">
<span class="sig-name descname"><span class="pre">rename_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_table_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.rename_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.rename_table" title="Link to this definition"></a></dt>
<dd><p>Rename an existing table.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You cannot move schemas when renaming a table. Instead, utilize
the <code class="xref py py-meth docutils literal notranslate"><span class="pre">table_duplicate()</span></code>. method.</p>
</div>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>table_name: str</dt><dd><p>Name of existing schema and table (e.g. <code class="docutils literal notranslate"><span class="pre">myschema.oldtable</span></code>)</p>
</dd>
<dt>new_table_name: str</dt><dd><p>New name for table with the schema omitted (e.g. <code class="docutils literal notranslate"><span class="pre">newtable</span></code>).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.move_table">
<span class="sig-name descname"><span class="pre">move_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_source_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.move_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.move_table" title="Link to this definition"></a></dt>
<dd><p>Move an existing table in the database.It will inherit encoding, sortkey
and distkey. <strong>Once run, the source table rows will be empty.</strong> This is
more efficiant than running <code class="docutils literal notranslate"><span class="pre">&quot;create</span> <span class="pre">newtable</span> <span class="pre">as</span> <span class="pre">select</span> <span class="pre">*</span> <span class="pre">from</span> <span class="pre">oldtable&quot;</span></code>.</p>
<p>For more information see: <a class="reference external" href="https://docs.aws.amazon.com/redshift/latest/dg/r_ALTER_TABLE_APPEND.html">ALTER TABLE APPEND</a></p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>source_table: str</dt><dd><p>Name of existing schema and table (e.g. <code class="docutils literal notranslate"><span class="pre">my_schema.old_table</span></code>)</p>
</dd>
<dt>new_table: str</dt><dd><p>New name of schema and table (e.g. <code class="docutils literal notranslate"><span class="pre">my_schema.newtable</span></code>)</p>
</dd>
<dt>drop_original: boolean</dt><dd><p>Drop the source table.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.populate_table_from_query">
<span class="sig-name descname"><span class="pre">populate_table_from_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destination_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_exists</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fail'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distkey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sortkey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.populate_table_from_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.populate_table_from_query" title="Link to this definition"></a></dt>
<dd><p>Populate a Redshift table with the results of a SQL query, creating the table if it
doesn’t yet exist.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>query: str</dt><dd><p>The SQL query</p>
</dd>
<dt>destination_table: str</dt><dd><p>Name of destination schema and table (e.g. <code class="docutils literal notranslate"><span class="pre">mys_chema.new_table</span></code>)</p>
</dd>
<dt>if_exists: str</dt><dd><p>If the table already exists, either <code class="docutils literal notranslate"><span class="pre">fail</span></code>, <code class="docutils literal notranslate"><span class="pre">append</span></code>, <code class="docutils literal notranslate"><span class="pre">drop</span></code>,
or <code class="docutils literal notranslate"><span class="pre">truncate</span></code> the table.</p>
</dd>
<dt>distkey: str</dt><dd><p>The column to use as the distkey for the table.</p>
</dd>
<dt>sortkey: str</dt><dd><p>The column to use as the sortkey for the table.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.duplicate_table">
<span class="sig-name descname"><span class="pre">duplicate_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destination_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">where_clause</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_exists</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fail'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_source_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.duplicate_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.duplicate_table" title="Link to this definition"></a></dt>
<dd><p>Create a copy of an existing table (or subset of rows) in a new
table. It will inherit encoding, sortkey and distkey.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>source_table: str</dt><dd><p>Name of existing schema and table (e.g. <code class="docutils literal notranslate"><span class="pre">myschema.oldtable</span></code>)</p>
</dd>
<dt>destination_table: str</dt><dd><p>Name of destination schema and table (e.g. <code class="docutils literal notranslate"><span class="pre">myschema.newtable</span></code>)</p>
</dd>
<dt>where_clause: str</dt><dd><p>An optional where clause (e.g. <code class="docutils literal notranslate"><span class="pre">where</span> <span class="pre">org</span> <span class="pre">=</span> <span class="pre">1</span></code>).</p>
</dd>
<dt>if_exists: str</dt><dd><p>If the table already exists, either <code class="docutils literal notranslate"><span class="pre">fail</span></code>, <code class="docutils literal notranslate"><span class="pre">append</span></code>, <code class="docutils literal notranslate"><span class="pre">drop</span></code>,
or <code class="docutils literal notranslate"><span class="pre">truncate</span></code> the table.</p>
</dd>
<dt>drop_source_table: boolean</dt><dd><p>Drop the source table</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.union_tables">
<span class="sig-name descname"><span class="pre">union_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_table_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">union_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.union_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.union_tables" title="Link to this definition"></a></dt>
<dd><p>Union a series of table into a new table.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>new_table_name: str</dt><dd><p>The new table and schema (e.g. <code class="docutils literal notranslate"><span class="pre">myschema.newtable</span></code>)</p>
</dd>
<dt>tables: list</dt><dd><p>A list of tables to union</p>
</dd>
<dt>union_all: boolean</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code> will deduplicate rows. If <code class="docutils literal notranslate"><span class="pre">True</span></code> will include
duplicate rows.</p>
</dd>
<dt>view: boolean</dt><dd><p>Create a view rather than a static table</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.get_tables">
<span class="sig-name descname"><span class="pre">get_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.get_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.get_tables" title="Link to this definition"></a></dt>
<dd><p>List the tables in a schema including metadata.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>schema: str</dt><dd><p>Filter by a schema</p>
</dd>
<dt>table_name: str</dt><dd><p>Filter by a table name</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><dl class="simple">
<dt>Parsons Table</dt><dd><p>See <a class="reference internal" href="table.html#parsons-table"><span class="std std-ref">Parsons Table</span></a> for output options.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.get_table_stats">
<span class="sig-name descname"><span class="pre">get_table_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.get_table_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.get_table_stats" title="Link to this definition"></a></dt>
<dd><p>List the tables statistics includes row count and size.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method is only accessible by Redshift <em>superusers</em>.</p>
</div>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>schema: str</dt><dd><p>Filter by a schema</p>
</dd>
<dt>table_name: str</dt><dd><p>Filter by a table name</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><dl class="simple">
<dt>Parsons Table</dt><dd><p>See <a class="reference internal" href="table.html#parsons-table"><span class="std std-ref">Parsons Table</span></a> for output options.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.get_columns">
<span class="sig-name descname"><span class="pre">get_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.get_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.get_columns" title="Link to this definition"></a></dt>
<dd><p>Gets the column names (and some other column info) for a table.</p>
<p>If you just need the column names, run <code class="docutils literal notranslate"><span class="pre">get_columns_list()</span></code> as it is faster.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">rs</span><span class="o">.</span><span class="n">get_columns</span><span class="p">(</span><span class="s1">&#39;some_schema&#39;</span><span class="p">,</span> <span class="s1">&#39;some_table&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</pre></div>
</div>
<dl>
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>schema: str</dt><dd><p>The schema name</p>
</dd>
<dt>table_name: str</dt><dd><p>The table name</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><p>A dict mapping column name to a dict with extra info. The keys of the dict are ordered
just like the columns in the table. The extra info is a dict with format</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s1">&#39;data_type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="s1">&#39;max_length&#39;</span><span class="p">:</span> <span class="nb">int</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
<span class="s1">&#39;max_precision&#39;</span><span class="p">:</span> <span class="nb">int</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
<span class="s1">&#39;max_scale&#39;</span><span class="p">:</span> <span class="nb">int</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
<span class="s1">&#39;is_nullable&#39;</span><span class="p">:</span> <span class="nb">bool</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.get_columns_list">
<span class="sig-name descname"><span class="pre">get_columns_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.get_columns_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.get_columns_list" title="Link to this definition"></a></dt>
<dd><p>Gets the just the column names for a table.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>schema: str</dt><dd><p>The schema name</p>
</dd>
<dt>table_name: str</dt><dd><p>The table name</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><p>A list of column names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.get_views">
<span class="sig-name descname"><span class="pre">get_views</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.get_views"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.get_views" title="Link to this definition"></a></dt>
<dd><p>List views.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>schema: str</dt><dd><p>Filter by a schema</p>
</dd>
<dt>view: str</dt><dd><p>Filter by a table name</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><dl class="simple">
<dt>Parsons Table</dt><dd><p>See <a class="reference internal" href="table.html#parsons-table"><span class="std std-ref">Parsons Table</span></a> for output options.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.get_queries">
<span class="sig-name descname"><span class="pre">get_queries</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.get_queries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.get_queries" title="Link to this definition"></a></dt>
<dd><p>Return the Current queries running and queueing, along with resource consumption.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Must be a Redshift superuser to run this method.</p>
</div>
<dl class="simple">
<dt><cite>Returns:</cite></dt><dd><dl class="simple">
<dt>Parsons Table</dt><dd><p>See <a class="reference internal" href="table.html#parsons-table"><span class="std std-ref">Parsons Table</span></a> for output options.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.get_max_value">
<span class="sig-name descname"><span class="pre">get_max_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_column</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.get_max_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.get_max_value" title="Link to this definition"></a></dt>
<dd><p>Return the max value from a table.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>table_name: str</dt><dd><p>Schema and table name</p>
</dd>
<dt>value_column: str</dt><dd><p>The column containing the values</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.get_object_type">
<span class="sig-name descname"><span class="pre">get_object_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.get_object_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.get_object_type" title="Link to this definition"></a></dt>
<dd><p>Get object type.</p>
<p>One of <cite>view</cite>, <cite>table</cite>, <cite>index</cite>, <cite>sequence</cite>, or <cite>TOAST table</cite>.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>object_name: str</dt><dd><p>The schema.obj for which to get the object type.</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><p><cite>str</cite> of the object type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.is_view">
<span class="sig-name descname"><span class="pre">is_view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.is_view"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.is_view" title="Link to this definition"></a></dt>
<dd><p>Return true if the object is a view.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>object_name: str</dt><dd><p>The schema.obj to test if it’s a view.</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><p><cite>bool</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.is_table">
<span class="sig-name descname"><span class="pre">is_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.is_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.is_table" title="Link to this definition"></a></dt>
<dd><p>Return true if the object is a table.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>object_name: str</dt><dd><p>The schema.obj to test if it’s a table.</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><p><cite>bool</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.get_table_definition">
<span class="sig-name descname"><span class="pre">get_table_definition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.get_table_definition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.get_table_definition" title="Link to this definition"></a></dt>
<dd><p>Get the table definition (i.e. the create statement).</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>table: str</dt><dd><p>The schema.table for which to get the table definition.</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.get_table_definitions">
<span class="sig-name descname"><span class="pre">get_table_definitions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.get_table_definitions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.get_table_definitions" title="Link to this definition"></a></dt>
<dd><p>Get the table definition (i.e. the create statement) for multiple tables.</p>
<p>This works similar to <cite>get_table_def</cite> except it runs a single query
to get the ddl for multiple tables. It supports SQL wildcards for
<cite>schema</cite> and <cite>table</cite>. Only returns the ddl for _tables_ that match
<cite>schema</cite> and <cite>table</cite> if they exist.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>schema: str</dt><dd><p>The schema to filter by.</p>
</dd>
<dt>table: str</dt><dd><p>The table to filter by.</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><p><cite>list</cite> of dicts with matching tables.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.get_view_definition">
<span class="sig-name descname"><span class="pre">get_view_definition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">view</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.get_view_definition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.get_view_definition" title="Link to this definition"></a></dt>
<dd><p>Get the view definition (i.e. the create statement).</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>view: str</dt><dd><p>The schema.view for which to get the view definition.</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.get_view_definitions">
<span class="sig-name descname"><span class="pre">get_view_definitions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.get_view_definitions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.get_view_definitions" title="Link to this definition"></a></dt>
<dd><p>Get the view definition (i.e. the create statement) for multiple views.</p>
<p>This works similar to <cite>get_view_def</cite> except it runs a single query
to get the ddl for multiple views. It supports SQL wildcards for
<cite>schema</cite> and <cite>view</cite>. Only returns the ddl for _views_ that match
<cite>schema</cite> and <cite>view</cite> if they exist.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>schema: str</dt><dd><p>The schema to filter by.</p>
</dd>
<dt>view: str</dt><dd><p>The view to filter by.</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><p><cite>list</cite> of dicts with matching views.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.split_full_table_name">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">split_full_table_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_table_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.split_full_table_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.split_full_table_name" title="Link to this definition"></a></dt>
<dd><p>Split a full table name into its schema and table. If a schema isn’t
present, return <cite>public</cite> for the schema. Similarly, Redshift defaults
to the <cite>public</cite> schema, when one isn’t provided.</p>
<p>Eg:
<code class="docutils literal notranslate"><span class="pre">(schema,</span> <span class="pre">table)</span> <span class="pre">=</span> <span class="pre">Redshift.split_full_table_name(&quot;some_schema.some_table&quot;)</span></code></p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>full_table_name: str</dt><dd><p>The table name, as “schema.table”</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><dl class="simple">
<dt>tuple</dt><dd><p>A tuple containing (schema, table)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftTableUtilities.combine_schema_and_table_name">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">combine_schema_and_table_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_table_utilities.html#RedshiftTableUtilities.combine_schema_and_table_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftTableUtilities.combine_schema_and_table_name" title="Link to this definition"></a></dt>
<dd><p>Creates a full table name by combining a schema and table.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>schema: str</dt><dd><p>The schema name</p>
</dd>
<dt>table: str</dt><dd><p>The table name</p>
</dd>
</dl>
</dd>
<dt><cite>Returns:</cite></dt><dd><dl class="simple">
<dt>str</dt><dd><p>The combined full table name</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="schema-api">
<span id="redshift-schema-api"></span><h3>Schema API<a class="headerlink" href="#schema-api" title="Link to this heading"></a></h3>
<p>Schema utilities are a series of helper methods, all built off of commonly
used SQL queries run against the Redshift database.</p>
<dl class="py class">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftSchema">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">parsons.databases.redshift.redshift.</span></span><span class="sig-name descname"><span class="pre">RedshiftSchema</span></span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_schema.html#RedshiftSchema"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftSchema" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftSchema.create_schema_with_permissions">
<span class="sig-name descname"><span class="pre">create_schema_with_permissions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_schema.html#RedshiftSchema.create_schema_with_permissions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftSchema.create_schema_with_permissions" title="Link to this definition"></a></dt>
<dd><p>Creates a Redshift schema (if it doesn’t already exist), and grants usage permissions to
a Redshift group (if specified).</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>schema: str</dt><dd><p>The schema name</p>
</dd>
<dt>group: str</dt><dd><p>The Redshift group name</p>
</dd>
<dt>type: str</dt><dd><p>The type of permissions to grant. Supports <cite>select</cite>, <cite>all</cite>, etc. (For
full list, see the
<a class="reference external" href="https://docs.aws.amazon.com/redshift/latest/dg/r_GRANT.html">Redshift GRANT docs</a>)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parsons.databases.redshift.redshift.RedshiftSchema.grant_schema_permissions">
<span class="sig-name descname"><span class="pre">grant_schema_permissions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permissions_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'select'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/parsons/databases/redshift/rs_schema.html#RedshiftSchema.grant_schema_permissions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#parsons.databases.redshift.redshift.RedshiftSchema.grant_schema_permissions" title="Link to this definition"></a></dt>
<dd><p>Grants a Redshift group permissions to all tables within an existing schema.</p>
<dl class="simple">
<dt><cite>Args:</cite></dt><dd><dl class="simple">
<dt>schema: str</dt><dd><p>The schema name</p>
</dd>
<dt>group: str</dt><dd><p>The Redshift group name</p>
</dd>
<dt>type: str</dt><dd><p>The type of permissions to grant. Supports <cite>select</cite>, <cite>all</cite>, etc. (For
full list, see the
<a class="reference external" href="https://docs.aws.amazon.com/redshift/latest/dg/r_GRANT.html">Redshift GRANT docs</a>)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="auth0.html" class="btn btn-neutral float-left" title="Auth0" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="azure.html" class="btn btn-neutral float-right" title="Azure: Blob Storage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, The Movement Cooperative.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      stable
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Most Common</dt>
        <!-- Show latest & stable first -->
        
            
        
            
        
            
        
            
        
            
        
            
        
            
                  <dd><a href="../latest/aws.html">latest</a></dd>
            
        
            
                  <dd><a href="aws.html">stable</a></dd>
            
        

        <dt>By Version Number</dt>
        <!-- Show other versions -->
        
            
                  <dd><a href="../v0.14.0/aws.html">v0.14.0</a></dd>
            
        
            
                  <dd><a href="../v0.15.0/aws.html">v0.15.0</a></dd>
            
        
            
                  <dd><a href="../v0.16.0/aws.html">v0.16.0</a></dd>
            
        
            
                  <dd><a href="../v0.17.0/aws.html">v0.17.0</a></dd>
            
        
            
                  <dd><a href="../v0.18.0/aws.html">v0.18.0</a></dd>
            
        
            
                  <dd><a href="../v0.18.1/aws.html">v0.18.1</a></dd>
            
        
            
        
            
        

      </dl>
    </div>
  </div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>